{{extend 'layout.html'}}

<h2>Vendor Dashboard</h2>

<div class="section">
    <h3>Status</h3>
    <p>
        <strong>Working:</strong>
        {{if vendor.is_working:}}
            <span style="color:green;">Yes</span>
        {{else:}}
            <span style="color:red;">No</span>
        {{pass}}
    </p>

    <form action="{{=URL('toggle_working')}}" method="post">
        <button class="btn-primary">Toggle Working</button>
    </form>
</div>

<hr>

<div class="section">
    <h3>Your Profile</h3>
    <p><strong>Name:</strong> {{=vendor.real_name}}</p>
    <p><strong>Address:</strong> {{=vendor.address}}</p>
    <p><strong>Phone:</strong> {{=vendor.phone}}</p>
    <p><strong>Email:</strong> {{=vendor.email}}</p>
    <p><strong>Borrowed:</strong> {{=vendor.amount_borrowed}}</p>
    <p><strong>Paid Back:</strong> {{=vendor.amount_paid_back}}</p>
</div>

<hr>

<div class="section">
    <h3>Your Messages From MFI</h3>

    {{if messages:}}
        <ul>
        {{for m in messages:}}
            <li>
                <strong>{{=m.created_on}}:</strong> {{=m.message}}
            </li>
        {{pass}}
        </ul>
    {{else:}}
        <p>No messages yet.</p>
    {{pass}}
</div>

<hr>

<div class="section">
    <h3>Write Message to MFI</h3>
    <form action="{{=URL('send_message')}}" method="post">
        <textarea name="message" rows="3" style="width:100%;" placeholder="Type your message"></textarea>
        <button class="btn-primary">Send Message</button>
    </form>
</div>

<hr>

<div class="section">
    <h3>Your Customer Micro-Page</h3>

    <form action="{{=URL('save_micro_page')}}" method="post">
        <textarea name="text" rows="4" style="width:100%;">{{=flyer.thecontent if flyer else ''}}</textarea>
        <button class="btn-primary">Save Customer Message</button>
    </form>

    <p>
        <a href="{{=URL('preview')}}">Preview</a> |
        <a href="{{=URL('qr', args=[vendor.username])}}" target="_blank">Show QR Code</a> |
        <a href="{{=URL('public', args=[vendor.username])}}" target="_blank">View Public Page</a>
    </p>
</div>
